<nav class="menu" aria-label="Действия">
    <form class="js-game-form" method="post" action="{% url 'game:action' %}">
        {% csrf_token %}
        <input type="hidden" name="action" value="start_over">
        <button type="submit">Начать заново</button>
    </form>
    <form class="js-game-form" method="post" action="{% url 'game:action' %}">
        {% csrf_token %}
        <input type="hidden" name="action" value="check_del">
        <button type="submit">Проверить, есть ли что стереть</button>
    </form>
    <form class="js-game-form" method="post" action="{% url 'game:action' %}">
        {% csrf_token %}
        <input type="hidden" name="action" value="continue">
        <button type="submit">Продолжить</button>
    </form>
    <form class="js-game-form" method="post" action="{% url 'game:action' %}">
        {% csrf_token %}
        <input type="hidden" name="action" value="undo">
        <button type="submit">Отменить последнее зачеркивание</button>
    </form>
</nav>

<div class="main-row-wrapper">
<div class="main-row">
    <div class="grid-wrap">
        <div class="grid">
            {% for cell in cells %}
            <div class="cell state-{{ cell.state }} {% if selected_index == cell.index %}selected{% endif %} {% if cell.index in prompted_indices %}prompted{% endif %}"
                 data-index="{{ cell.index }}"
                 data-state="{{ cell.state }}">
                {% if cell.state == '2' %}
                    <span>0</span>
                {% else %}
                    {% if selected_index is not None %}
                        {% if selected_index == cell.index %}
                            <form class="cell-form js-game-form" method="post" action="{% url 'game:action' %}">
                                {% csrf_token %}
                                <input type="hidden" name="action" value="clear_selection">
                                <button type="submit" class="cell-btn">{{ cell.text }}</button>
                            </form>
                        {% else %}
                            <form class="cell-form js-game-form" method="post" action="{% url 'game:action' %}">
                                {% csrf_token %}
                                <input type="hidden" name="action" value="strike">
                                <input type="hidden" name="i0" value="{{ selected_index }}">
                                <input type="hidden" name="i1" value="{{ cell.index }}">
                                <button type="submit" class="cell-btn">{{ cell.text }}</button>
                            </form>
                        {% endif %}
                    {% else %}
                        <form class="cell-form js-game-form" method="post" action="{% url 'game:action' %}">
                            {% csrf_token %}
                            <input type="hidden" name="action" value="select">
                            <input type="hidden" name="index" value="{{ cell.index }}">
                            <button type="submit" class="cell-btn">{{ cell.text }}</button>
                        </form>
                    {% endif %}
                {% endif %}
            </div>
            {% endfor %}
        </div>
    </div>
    {% if messages %}
    <ul class="messages">
        {% for message in messages %}
        <li class="{{ message.tags }}">{{ message }}</li>
        {% endfor %}
    </ul>
    {% endif %}
</div>
</div>

{% if won %}
<p class="won">Поздравляю, вы выиграли!</p>
{% endif %}
